# 文件转换功能说明

## 功能概述

文件转换功能是图文格式转换工具的核心功能之一，支持多种文档格式之间的相互转换。

## 支持的文件格式

### 输入格式
- **PDF** (.pdf) - Adobe PDF文档
- **DOC** (.doc) - Microsoft Word 97-2003文档
- **DOCX** (.docx) - Microsoft Word 2007+文档
- **TXT** (.txt) - 纯文本文件
- **RTF** (.rtf) - 富文本格式文件

### 输出格式
- **PDF** (.pdf) - 转换为PDF格式
- **DOC** (.doc) - 转换为Word 97-2003格式
- **DOCX** (.docx) - 转换为Word 2007+格式
- **TXT** (.txt) - 转换为纯文本格式
- **RTF** (.rtf) - 转换为富文本格式

## 转换支持矩阵

| 源格式 | PDF | DOC | DOCX | TXT | RTF |
|--------|-----|-----|------|-----|-----|
| PDF    | ❌  | ✅  | ❌   | ✅  | ❌  |
| DOC    | ✅  | ❌  | ❌   | ✅  | ❌  |
| DOCX   | ✅  | ❌  | ❌   | ✅  | ❌  |
| TXT    | ✅  | ✅  | ✅   | ✅  | ❌  |
| RTF    | ✅  | ✅  | ❌   | ✅  | ❌  |

**注意**：
- PDF生成功能使用jsPDF库，生成的PDF文件符合标准格式，可以在任何PDF阅读器中正常打开。
- DOCX生成功能创建包含XML结构的文件，由于浏览器限制，无法直接生成ZIP格式的DOCX文件。

## 使用方法

### 1. 访问文件转换页面
打开 `pages/file-convert.html` 页面。

### 2. 上传文件
- **拖拽上传**：将文件拖拽到上传区域
- **点击上传**：点击"选择文件"按钮选择文件
- **批量上传**：支持同时选择多个文件

### 3. 设置转换参数
- **源格式**：选择源文件格式（可选自动检测）
- **目标格式**：选择要转换的目标格式
- **转换质量**：选择转换质量（高/中/低）

### 4. 开始转换
- 点击"开始批量转换"按钮
- 查看转换进度
- 等待转换完成

### 5. 下载结果
- 单个下载：点击文件旁的下载按钮
- 批量下载：点击"批量下载"按钮

## 技术实现

### 前端架构
- **纯前端实现**：所有转换在浏览器本地完成
- **无后端依赖**：无需服务器支持
- **隐私保护**：文件不上传到服务器

### 核心技术
- **jsPDF**：生成标准的PDF文件
- **JSZip**：解析DOCX文件的ZIP格式
- **PDF.js**：处理PDF文件的读取和转换
- **Mammoth.js**：处理Word文档的读取和转换
- **File API**：处理文件上传和下载
- **Canvas API**：处理图片格式转换
- **Web Workers**：后台处理，避免阻塞UI

### 文件处理流程
1. **文件验证**：检查文件类型、大小和格式
2. **库加载**：动态加载必要的处理库
3. **格式检测**：自动检测文件格式
4. **内容提取**：从源文件中提取文本内容
5. **格式转换**：将内容转换为目标格式
6. **结果生成**：生成转换后的文件
7. **下载提供**：提供转换结果下载

## 性能优化

### 文件大小限制
- **最大文件大小**：50MB
- **批量处理**：最多同时处理10个文件
- **内存优化**：使用流式处理大文件

### 转换质量设置
- **高质量**：保持最佳格式和布局
- **中等质量**：平衡质量和文件大小
- **低质量**：优先考虑文件大小

## 错误处理

### 常见错误
- **文件格式不支持**：上传了不支持的格式
- **文件过大**：超过50MB限制
- **文件为空**：上传了空文件
- **转换失败**：转换过程中出现错误

### 错误提示
- 友好的错误提示信息
- 详细的错误原因说明
- 建议的解决方案

## 浏览器兼容性

### 支持的浏览器
- **Chrome** 60+
- **Firefox** 55+
- **Safari** 12+
- **Edge** 79+

### 功能要求
- **File API**：文件上传和读取
- **Blob API**：文件下载
- **Canvas API**：图片处理
- **Web Workers**：后台处理

## 安全考虑

### 文件安全
- **本地处理**：所有文件在本地处理
- **不上传**：文件不会上传到服务器
- **临时存储**：使用临时变量，不持久化

### 隐私保护
- **无数据收集**：不收集用户文件信息
- **无跟踪**：不跟踪用户行为
- **无广告**：无第三方广告

## 测试

### 测试页面
- `test-file-convert.html` - 文件转换功能测试
- `test-pdf-generation.html` - PDF生成功能测试
- `test-docx-conversion.html` - DOCX转换功能测试
- `test-txt-to-docx.html` - TXT转DOCX功能测试

### 测试项目
- PDF转TXT测试
- DOC转TXT测试
- DOCX转TXT测试
- DOCX转PDF测试
- TXT转DOC测试
- TXT转DOCX测试
- PDF生成测试（支持中文）
- 文件验证测试
- 错误处理测试

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 支持PDF、DOC、DOCX、TXT、RTF格式转换
- 实现拖拽上传和批量处理
- 添加进度显示和错误处理

## 技术支持

### 问题反馈
如果遇到问题，请检查：
1. 文件格式是否支持
2. 文件大小是否超限
3. 浏览器是否支持相关API
4. 网络连接是否正常

### 功能建议
欢迎提出功能改进建议，包括：
- 支持更多文件格式
- 优化转换质量
- 改进用户界面
- 添加新功能 